<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Registro - Gestor de Tareas</title>
        <meta name="description" content="">
        <link rel="stylesheet" href="">
        <style>
        body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background-color: #f4f4f9; }
        .login-box { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); width: 300px; }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        /* Le cambiamos el color al botón para diferenciarlo del Login */
        button { width: 100%; padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #0056b3; }
        #mensajeError { color: red; font-size: 14px; display: none; margin-top: 10px; }
        #mensajeExito { color: green; font-size: 14px; display: none; margin-top: 10px; }
        .link-volver { display: block; text-align: center; margin-top: 15px; font-size: 14px; color: #555; text-decoration: none; }
        .link-volver:hover { text-decoration: underline; }
    </style>
    </head>
    <body>
       <div class="login-box">
        <h2>Crear Cuenta</h2>
        <form id="registroForm">
            <input type="text" id="name" placeholder="Tu nombre" required>
            <input type="email" id="email" placeholder="Tu correo electrónico" required>
            <input type="password" id="password" placeholder="Tu contraseña" required>
            <button type="submit">Registrarse</button>
            <p id="mensajeError">Error al registrar.</p>
            <p id="mensajeExito">¡Cuenta creada! Llevándote al Login...</p>
        </form>
        <a href="index.html" class="link-volver">¿Ya tienes cuenta? Inicia sesión aquí</a>
        </div>
        
        <script>
            const registroForm = document.getElementById("registroForm")
            const mensajeError = document.getElementById("mensajeError")
            const mensajeExito = document.getElementById("mensajeExito")

            registroForm.addEventListener("submit", async(e) =>{
                e.preventDefault()

                const name  = document.getElementById("name").value
                const email = document.getElementById("email").value
                const password = document.getElementById("password").value

                mensajeError.style.display = "none"
                mensajeExito.style.display = "none"

                try{
                    const response = await fetch('http://localhost:3000/api/auth/register',{
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({name,email,password})
                    })

                    const data = await response.json()

                    if (response.ok){
                        mensajeExito.style.display = "block"

                        setTimeout(() =>{
                            window.location.href = "index.html"
                        },2000)
                    }else{
                        mensajeError.textContent = data.message || "Error al registrarse"
                        mensajeError.style.display = "block"
                    }

                }catch(error){
                    console.error("Error de conexión", error)
                    mensajeError.textContent = "Error al conectar con el servidor local."
                    mensajeError.style.display = "block"

                }
            })
        </script>
    </body>
</html>